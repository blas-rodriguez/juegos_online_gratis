<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Aventura en la Cueva</title>
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
            background-color: #111827;
            color: #e5e7eb;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }
        .game-container {
            max-width: 700px;
            width: 100%;
            background: #1f2937;
            border-radius: 12px;
            padding: 20px 24px;
            box-shadow: 0 20px 35px rgba(0,0,0,0.5);
        }
        h1 {
            text-align: center;
            margin-top: 0;
            color: #fbbf24;
        }
        #game-text {
            white-space: pre-line;
            line-height: 1.5;
            margin-bottom: 16px;
        }
        .choices {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        button {
            padding: 10px 14px;
            border-radius: 8px;
            border: none;
            cursor: pointer;
            background-color: #2563eb;
            color: white;
            font-size: 14px;
            text-align: left;
            transition: transform 0.05s ease, box-shadow 0.05s ease, background-color 0.15s ease;
        }
        button:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 10px rgba(0,0,0,0.35);
            background-color: #1d4ed8;
        }
        button.secondary {
            background-color: #4b5563;
        }
        button.secondary:hover {
            background-color: #374151;
        }
        .input-row {
            margin-top: 12px;
            display: flex;
            gap: 8px;
        }
        input[type="text"] {
            flex: 1;
            padding: 8px 10px;
            border-radius: 8px;
            border: 1px solid #4b5563;
            background-color: #111827;
            color: #e5e7eb;
        }
        small {
            color: #9ca3af;
        }
    </style>
</head>
<body>
<div class="game-container">
    <h1>Aventura en la Cueva</h1>
    <div id="game-text"></div>
    <div id="game-extra"></div>
    <div class="choices" id="choices"></div>
</div>

<script>
    const gameText = document.getElementById('game-text');
    const gameExtra = document.getElementById('game-extra');
    const choicesDiv = document.getElementById('choices');

    const gameState = {
        nombre: '',
        llave: false,
        finalizado: false,
    };

    function setText(text) {
        gameText.textContent = text;
    }

    function clearExtra() {
        gameExtra.innerHTML = '';
    }

    function addChoice(label, onClick, options = {}) {
        const btn = document.createElement('button');
        btn.textContent = label;
        if (options.secondary) btn.classList.add('secondary');
        btn.onclick = onClick;
        choicesDiv.appendChild(btn);
    }

    function clearChoices() {
        choicesDiv.innerHTML = '';
    }

    // === ESCENAS ===

    function escenaInicioNombre() {
        gameState.llave = false;
        gameState.finalizado = false;
        setText(
`Te despertás en una cueva oscura, solo con una antorcha casi apagada.
No recordás cómo llegaste aquí.

Antes de empezar... ¿cómo te llamás, aventurero/a?`
        );
        clearExtra();
        clearChoices();

        const row = document.createElement('div');
        row.className = 'input-row';

        const input = document.createElement('input');
        input.type = 'text';
        input.placeholder = 'Escribí tu nombre...';

        const btn = document.createElement('button');
        btn.textContent = 'Comenzar aventura';
        btn.onclick = () => {
            gameState.nombre = input.value.trim() || 'SinNombre';
            escenaInicio();
        };

        row.appendChild(input);
        row.appendChild(btn);
        gameExtra.appendChild(row);
    }

    function escenaInicio() {
        clearExtra();
        setText(
`Hola ${gameState.nombre}.
Te despertás en una cueva oscura, solo con una antorcha casi apagada.
A tu alrededor ves:

1) Un pasillo hacia la izquierda (se escuchan gotas de agua).
2) Un pasillo hacia la derecha (se siente un olor raro).
3) Quedarte donde estás y observar mejor.`
        );
        clearChoices();
        addChoice('1) Ir por el pasillo izquierdo', () => escenaPasilloIzquierda());
        addChoice('2) Ir por el pasillo derecho', () => escenaPasilloDerecha());
        addChoice('3) Observar mejor la sala inicial', () => escenaSalaInicial());
    }

    function escenaSalaInicial() {
        clearExtra();
        setText(
`Mirás mejor tu alrededor, ${gameState.nombre}.
Notás unas marcas en la pared que parecen flechas hacia la izquierda.

1) Seguir las flechas (izquierda).
2) Ignorarlas e ir a la derecha.`
        );
        clearChoices();
        addChoice('1) Seguir las flechas a la izquierda', () => escenaPasilloIzquierda());
        addChoice('2) Ir al pasillo derecho', () => escenaPasilloDerecha(), { secondary: true });
    }

    function escenaPasilloIzquierda() {
        clearExtra();
        setText(
`Caminás por el pasillo de la izquierda.
El eco de tus pasos resuena en la cueva.

Tras unos metros encontrás:
- Una puerta de madera muy vieja.
- Una pequeña mesa con algo brillando encima.

1) Revisar la mesa.
2) Intentar abrir la puerta.
3) Volver atrás.`
        );
        clearChoices();
        addChoice('1) Revisar la mesa', () => escenaMesaLlave());
        addChoice('2) Ir a la puerta de madera', () => escenaPuertaMadera());
        addChoice('3) Volver a la sala inicial', () => escenaInicio(), { secondary: true });
    }

    function escenaMesaLlave() {
        clearExtra();
        if (gameState.llave) {
            setText(
`Te acercás a la mesa.

Sobre la mesa ya no hay nada nuevo.
La llave oxidada ya la tenés contigo.`
            );
            clearChoices();
            addChoice('Volver al pasillo', () => escenaPasilloIzquierda());
            return;
        }

        setText(
`Te acercás a la mesa.
Ves una pequeña llave oxidada.

1) Tomar la llave.
2) No tocar nada y volver.`
        );
        clearChoices();
        addChoice('1) Tomar la llave oxidada', () => {
            gameState.llave = true;
            setText(
`Tomás la llave oxidada.

(¡Podría servir para alguna puerta!)

Volvés al pasillo.`
            );
            clearChoices();
            addChoice('Continuar', () => escenaPasilloIzquierda());
        });
        addChoice('2) Volver al pasillo sin tocar la llave', () => escenaPasilloIzquierda(), { secondary: true });
    }

    function escenaPuertaMadera() {
        clearExtra();
        if (gameState.llave) {
            setText(
`Te parás frente a la puerta de madera.

Usás la llave oxidada para intentar abrirla...

*CLACK*

La cerradura cede y abrís la puerta lentamente.`
            );
            clearChoices();
            addChoice('Entrar a la sala', () => escenaSalaTesoro());
        } else {
            setText(
`Te parás frente a la puerta de madera.

Intentás abrirla, pero está trabada y tiene una cerradura.
No parecés tener ninguna llave para abrirla.`
            );
            clearChoices();
            addChoice('Volver al pasillo', () => escenaPasilloIzquierda());
        }
    }

    function escenaSalaTesoro() {
        clearExtra();
        setText(
`Entrás a una sala iluminada por cristales en el techo.
En el centro hay un cofre antiguo.

1) Abrir el cofre.
2) Volver a la puerta e irte.`
        );
        clearChoices();
        addChoice('1) Abrir el cofre', () => escenaCofre());
        addChoice('2) Volver al pasillo', () => escenaPasilloIzquierda(), { secondary: true });
    }

    function escenaCofre() {
        clearExtra();
        setText(
`Te acercás al cofre, ${gameState.nombre}.
Lo abrís lentamente...

Dentro encontrás monedas de oro, joyas
y un mapa que indica una salida secreta de la cueva.

¡Has encontrado el TESORO y escapado con vida!

========== FINAL BUENO ==========
`
        );
        gameState.finalizado = true;
        mostrarReinicio();
    }

    function escenaPasilloDerecha() {
        clearExtra();
        setText(
`Tomás el pasillo de la derecha.
El olor raro se hace cada vez más fuerte.
Escuchás un gruñido a lo lejos...

1) Seguir avanzando.
2) Volver a la zona inicial.`
        );
        clearChoices();
        addChoice('1) Seguir avanzando', () => escenaGuaridaMonstruo());
        addChoice('2) Volver a la sala inicial', () => escenaInicio(), { secondary: true });
    }

    function escenaGuaridaMonstruo() {
        clearExtra();
        setText(
`Llegás a una sala amplia.
Un monstruo enorme te observa desde la oscuridad.
Sus ojos rojos brillan.

1) Intentar hablar con el monstruo.
2) Salir corriendo.
3) Tomar una piedra del suelo y atacar.`
        );
        clearChoices();
        addChoice('1) Hablar con el monstruo', () => escenaHablarMonstruo());
        addChoice('2) Salir corriendo', () => escenaHuirMonstruo());
        addChoice('3) Atacar al monstruo con una piedra', () => escenaAtacarMonstruo());
    }

    function escenaHablarMonstruo() {
        clearExtra();
        setText(
`Te armás de valor y le hablás al monstruo:

"No quiero hacerte daño, solo busco salir de aquí" - decís.

El monstruo te mira fijamente... y comienza a reír.
Resulta ser un guardián aburrido.

Te señala un pasillo secreto que lleva fuera de la cueva.

¡Has escapado gracias a tu valentía y diálogo!

========== FINAL DIPLOMÁTICO ==========
`
        );
        gameState.finalizado = true;
        mostrarReinicio();
    }

    function escenaHuirMonstruo() {
        clearExtra();
        setText(
`Das media vuelta y corrés tan rápido como podés...
Pero tropezás con una roca y caés.

El monstruo se acerca...

FIN.
El miedo te jugó en contra, ${gameState.nombre}.

========== FINAL MALO ==========
`
        );
        gameState.finalizado = true;
        mostrarReinicio();
    }

    function escenaAtacarMonstruo() {
        clearExtra();
        setText(
`Tomás una piedra y corrés hacia el monstruo gritando.

El monstruo se sorprende por tu ataque.
Retrocede y deja descubierta una puerta detrás suyo.

Aprovechás la confusión y te colás por la puerta.

Del otro lado encontrás un túnel que lleva a la superficie.
Has escapado por pura osadía.

========== FINAL HEROICO ==========
`
        );
        gameState.finalizado = true;
        mostrarReinicio();
    }

    function mostrarReinicio() {
        clearExtra();
        clearChoices();
        addChoice('Jugar de nuevo', () => escenaInicioNombre());
        addChoice('Salir del juego', () => escenaSalir(), { secondary: true });
    }

    function escenaSalir() {
        clearExtra();
        setText(
`Gracias por jugar, ${gameState.nombre}.

Cerrá la pestaña o recargá la página si querés volver a empezar más adelante.`
        );
        clearChoices();
    }

    // Inicia el juego
    escenaInicioNombre();
</script>
</body>
</html>
